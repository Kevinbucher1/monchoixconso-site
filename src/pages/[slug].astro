---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getPages } from '../lib/strapi';

export async function getStaticPaths() {
    const pages = await getPages() ?? [];

    console.log('DONNÉES REÇUES PAR getStaticPaths:', JSON.stringify(pages, null, 2));

    if (!Array.isArray(pages)) {
        console.error("Les données reçues de Strapi ne sont pas un tableau. Construction impossible.");
        return [];
    }

    return pages.map((page) => ({
        params: { slug: page.slug },
        props: { page },
    }));
}
const { page } = Astro.props;
---
<BaseLayout pageTitle={page.slug} showFooter={page.afficher_footer}>
    {/* CORRECTION : On utilise un <div>, plus fiable pour injecter le HTML */}
    <div set:html={page.contenu} />
</BaseLayout>