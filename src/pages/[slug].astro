---
// Étape 1 : Importer les outils nécessaires
// CORRECTION : On s'assure que le nom du fichier est correct (pas d'espace)
import BaseLayout from '../layouts/BaseLayout.astro'; 

// CORRECTION : On utilise le bon nom de fonction, "getPages"
import { getPages } from '../lib/strapi';

// Étape 2 : Définir les chemins de toutes les pages à créer
export async function getStaticPaths() {
    // CORRECTION : On ajoute "?? []" pour la robustesse
    const pages = await getPages() ?? []; 

    // Pour le débogage, si besoin
    console.log('Données reçues de Strapi:', JSON.stringify(pages, null, 2));

    return pages.map((page) => ({
        params: { slug: page.slug },
        props: { page },
    }));
}

// Étape 3 : Récupérer les données pour CETTE page spécifique
const { page } = Astro.props;
---

<BaseLayout pageTitle={page.slug} showFooter={page.afficher_footer}>
    <Fragment set:html={page.contenu} />
</BaseLayout>